---
layout: post
title: NanoVNA Notes
description: "Some notes on the NanoVNA - The tiny, inexpensive Vector Network Analyzer. A few months ago, I purchased the amazing NanoVNA on ebay for about 50 bucks."
date: '2019-10-28T20:19:00.000-07:00'
author: gojimmypi
tags: 
modified_time: '2019-10-28T20:25:40.906-07:00'
thumbnail: https://1.bp.blogspot.com/-NYhl9_gmEl0/XbeLh5GlFPI/AAAAAAAACMw/xHrpGDKakYATt9mcIqXCZsgsLPZpQU6rgCLcBGAsYHQ/s72-c/NanoVNA%2Bin%2Ba%2Btin.jpg
blogger_id: tag:blogger.com,1999:blog-4109066286647243251.post-4718372717923464486
blogger_orig_url: https://gojimmypi.blogspot.com/2019/10/nanovna-notes.html
---

Some notes on the NanoVNA -&nbsp; The tiny, inexpensive Vector Network Analyzer.<br />
<br />A few months ago, I purchased the amazing&nbsp;
<a href="https://www.ebay.com/itm/NanoVNA-Vector-50KHz-900MHz-HF-VHF-UHF-Antenna-Network-Analyzer-2-8-LCD-Screen/143350757963">NanoVNA on ebay</a>
 for about 50 bucks. What an impressive work of engineering for such a ridiculously low price! Ok, admittedly the really cool stuff comes from the people that are working on open source software. That hardware would have much less value without the software,<br />
<br />
When ordering a new VNA, pay attention to what you get and what you might need. Mine came with the essential 50 ohm load, open, and short SMA plugs, 2 SMA cables, a USB-C cable, and a tin box.
<br />
<br />I didn't know it at the time (although probably not a surprise)... but there are a lot of imitations. ymmv. The only "official" one that I have since become aware of, is this 
<a href="https://www.nooelec.com/store/nanovna-bundle.html">Nooelec kit</a>
. Considering the time and hassle of ordering connectors that otherwise come included with this kit - I probably would have purchased it instead, had I known about it.<br />
<br />
Here's mine in a EMI-protective tin (that normally should have the lid on when you are using it!) measuring a cheap LoRa antenna:
<br />
<br />

<div class="separator" style="clear: both; text-align: center;">
<a href="../images/s1600/NanoVNA_in_a_tin.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
<img alt="illustration image" border="0" data-original-height="1200" data-original-width="860" height="320" src="../images/s320/NanoVNA_in_a_tin.jpg" width="228"></a>
</div>
<br />
<br />
The tin box is much more than a carrying case! I drilled some holes in mine and used it as a protective shield. Measuring antenna characteristics with, say your computer just inches away will almost certainly cause interference and erroneous results.
<br />
<br />I ended up paying nearly the same amount for a variety of adapters and connectors. There's an amazing variety available. 
<a href="https://www.ebay.com/itm/4Pcs-SMA-Male-to-IPX-U-fl-Male-Plug-Straight-RF-Adapter-Connector-UE/233361190115">SMA Male to IPX ufl</a>&nbsp;(e.g. the antenna adapter shown above),&nbsp;<a href="https://www.ebay.com/itm/4pcs-Set-BNC-to-SMA-Type-Male-Female-RF-Connector-Adapter-Test-Converter-Kit-NEW/322485698455">SMA to BNC</a> (e.g. Oscilloscope probe), <a href="https://www.ebay.com/itm/5pcs-F-Type-Female-Jack-To-SMA-Male-Plug-Straight-RF-Adapter-Connector-Converter/322897259310">SMA to F-Type</a>&nbsp;(e.g. cable TV),&nbsp;<a href="https://www.ebay.com/itm/3x-F-Type-Coax-Coaxial-Cable-Coupler-Male-Jack-Adapter-Connector-Lot-Pack/293167191656">F-type coax male</a>&nbsp;/ <a href="https://www.ebay.com/itm/10pcs-F-Type-Coax-Coaxial-Cable-Coupler-Female-Jack-Adapter-Connector/293165621046">F-type coax female</a> and a&nbsp;<a href="https://www.ebay.com/itm/18-Pcs-SMA-Kit-Connector-Male-Female-Plug-Antenna-Converter-Adapter-Coax/253193696403">variety of others</a>
&nbsp;are things to consider - depending on the need.<br />
<br />It's probably a personality 
<strike>disorder</strike>
&nbsp;quality attribute, but here are the adapters I ordered after I had my NanoVNA but realized I didn't have the right one on hand:<br />
<br />

<div class="separator" style="clear: both; text-align: center;">
<a href="../images/s1600/NanoVNA_adapters.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
<img alt="illustration image" border="0" data-original-height="1136" data-original-width="1194" height="304" src="../images/s320/NanoVNA_adapters.jpg" width="320"></a>
</div>
<br />
The little blue 3D-printed nut spinners were a cool gift. I had never used them, but certainly recommend them now! They are quite handy for tightening the SMA connectors,
<br />
<br />
A couple of key places for the NanoVNA user to be aware of:
<br />
<ul><li>NanoVNA User Group:&nbsp;<a href="https://groups.io/g/nanovna-user">https://groups.io/g/nanovna-user</a></li><li>NanoVNA User Wiki:&nbsp;<a href="https://groups.io/g/nanovna-users/wiki/home">https://groups.io/g/nanovna-users/wiki/home</a></li><li><a href="https://groups.io/g/nanovna-users/files/NanoVNA%20User%20Guide-English-reformat-Oct-2-19.pdf">NanoVNA User Guide</a> from the Wiki, translated from <a href="https://cho45.github.io/NanoVNA-manual/">cho45's manual</a>.</li><li>ttrftech's firmware:&nbsp;<a href="https://github.com/ttrftech/NanoVNA">https://github.com/ttrftech/NanoVNA</a></li><li>mihtjel's NanoVNA Saver:&nbsp;<a href="https://github.com/mihtjel/nanovna-saver">https://github.com/mihtjel/nanovna-saver</a></li><li>eddy555's ChibiOS&nbsp;<a href="https://github.com/edy555/ChibiOS">
https://github.com/edy555/ChibiOS</a></li></ul><br />Once you have a NanoVNA, unless you want to upgrade firmware - probably the only thing of interest (other than the documentation) - is the 
<a href="https://github.com/mihtjel/nanovna-saver/releases/latest">NanoVNA Saver software</a>
.<br />
<br />
<b>
Calibration is important!&nbsp;</b><br />
<br />There's an excellent, easy-to-understand 
<a href="https://groups.io/g/nanovna-users/message/93">sequence of pictures</a> that illustrates the plugs, cables, and connections for each step of calibration. From the&nbsp;<a href="https://cho45.github.io/NanoVNA-manual/">cho45 NanoVNA manual</a>
:<br />
<br />

<div style="background-color: white; box-sizing: border-box; color: #24292e; font-family: &quot;Noto Sans JP&quot;, sans-serif; font-size: 16px; margin-bottom: 16px;">
<span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">Calibration should basically be performed whenever the frequency range to be measured is changed.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">If the error is corrected correctly, the calibration status display on the screen will&nbsp;</span></span><code class="highlight">Cn D R S T X</code><span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">be.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">n is the data number being loaded.</span></span>
</div>

<div style="background-color: white; box-sizing: border-box; color: #24292e; font-family: &quot;Noto Sans JP&quot;, sans-serif; font-size: 16px; margin-bottom: 16px;">
<span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">However, NanoVNA can complement the existing calibration information and display to some extent correct.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">This will happen if the frequency range is changed after loading the calibration data.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">At this time, the calibration status is displayed on the screen&nbsp;</span></span><code class="highlight">cn D R S T X</code><span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">n is the data number being loaded.</span></span>
</div>
<ol style="background-color: white; box-sizing: border-box; color: #24292e; font-family: &quot;Noto Sans JP&quot;, sans-serif; font-size: 16px; margin-bottom: 16px; margin-top: 0px; padding-left: 2em;"><li style="box-sizing: border-box;"><span style="box-sizing: border-box; vertical-align: inherit;">Reset current calibration state&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">RESET</code></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Connect the OPEN standard to the CH0 port&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">OPEN</code><span style="box-sizing: border-box; vertical-align: inherit;">and execute.</span></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Connect the SHORT standard to the CH0 port&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">SHORT</code><span style="box-sizing: border-box; vertical-align: inherit;">and execute.</span></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Connect the LOAD standard to the CH0 port&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">LOAD</code><span style="box-sizing: border-box; vertical-align: inherit;">and execute.</span></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Connect the LOAD standard to the CH0 and CH1 ports&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">ISOLN</code><span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">and execute.&nbsp;</span><span style="box-sizing: border-box; vertical-align: inherit;">If there is only one load, the CH0 port can be left unconnected.</span></span></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Connect the cables to the CH0 and CH1 ports, connect the cables with the through connectors,&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">THRU</code><span style="box-sizing: border-box; vertical-align: inherit;">and execute.</span></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Finish calibration and calculate error correction information&nbsp;</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">DONE</code></li><li style="box-sizing: border-box; margin-top: 0.25em;"><span style="box-sizing: border-box; vertical-align: inherit;">Specify the data number and save.</span><code class="highlight">CAL</code>&nbsp;<code class="highlight">CALIBRATE</code>&nbsp;<code class="highlight">SAVE</code>&nbsp;<code class="highlight">SAVE 0</code></li></ol>
<div style="background-color: white; box-sizing: border-box; color: #24292e; font-family: &quot;Noto Sans JP&quot;, sans-serif; font-size: 16px; margin-bottom: 16px;">
<span style="box-sizing: border-box; vertical-align: inherit;">* Each calibration data must be imported after the display is sufficiently stable.</span>
</div>
<br />
<b>
Firmware notes:</b><br />
<br />
One of the most important things that I learned during the upgrade process is that there are apparently TWO different types of firmware. The standard version and the "AA" (Antenna Analyzer) version. Upload the wrong firmware, and I saw this mess of squiggly lines on the screen:
<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="../images/s1600/NotTheNanoyouwanttosee.png" imageanchor="1" style="margin-left: auto; margin-right: auto;">
<img alt="illustration image" border="0" data-original-height="470" data-original-width="784" height="238" src="../images/s400/NotTheNanoyouwanttosee.png" width="400"></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Not the NanoVNA you want to see,</td></tr></tbody></table>
This was the result of my compiled version off of GitHub. I was never able to get it to work. :/<br />
<br />Fortunately, one of the folks on the user groups posted some 
<a href="https://drive.google.com/drive/folders/1IRz6E1wlkRyV0u7sbqj0lhWST-GV1szY">useful files</a>
&nbsp;that helped me recover.<br />
<br />
When upgrading the firmware, DON'T FORGET THE JUMPER on the board. Yes, this is in upper case as even though it was listed in the instructions, I forgot that part and used Zadig the change the USB drivers BEFORE the jumper was in place. Don't do that.
<br />
<br />In fact, I didn't need Zadig at all, erm, once the BOOT0 jumper was in place. For more info on the dfu-util and Zadig, see&nbsp;
<a href="https://www.hanselman.com/blog/HowToFixDfuutilSTMWinUSBZadigBootloadersAndOtherFirmwareFlashingIssuesOnWindows.aspx">Scott Hanselman's Blog on How to fix dfu-util, STM, WinUSB, Zadig, Bootloaders and other Firmware Flashing issues on Windows</a>
.<br />
<br />
The board should be powered on with the BOOT0 jumper in place. You can remove the jumper after turning on the power and before uploading the firmware. I've left the jumper in place, uploaded the firmware, then powered down and removed the jumper. It seemed to work just fine.
<br />
<br />My BOOT0 jumper was in a completely different location (on a completely different board) as compared to the 
<a href="../images/doc/nanovna-pcb-photo.jpg">one on the ttrftech docs</a>
. Note my jumper was located under the batter LiPo connector:<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="../images/s1600/BOOT0.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;">
<img alt="illustration image" border="0" data-original-height="553" data-original-width="901" height="243" src="../images/s400/BOOT0.jpg" width="400"></a></td></tr><tr><td class="tr-caption" style="text-align: center;">
My NanoVNA with a temporary jumper at BOOT0</td></tr></tbody></table><br />
<br />
Note that more recent versions of the firmware have the ability to put the board into DFU mode. See the config menu option.
<br />
<br />Windows (and WSL Linux users) can download the 
<a href="https://sourceforge.net/projects/dfu-util/files/">dfu-util from SourceForce</a>&nbsp;(too bad that site is such a haven for excessive ads). I used the <a href="https://sourceforge.net/projects/dfu-util/files/dfu-util-0.9-win64.zip/download">64 bit Version 0.9</a>
.<br />
<br />
Despite there being an apt-get version of dfu-util for WSL Ubuntu, I was not able to get that version to recognize the NanoVNA. Fortunately Windows apps can also be used in WSL. Don't forget the "./" for WSL.
<br />
<br />
./dfu-util.exe -d 0483:df11 -a 0 -s 0x08000000:leave -D build/ch.bin 
<br />
<br />
<br />
More to come...
<br />
<br />
<br />
 Copyright (c) gojimmypi all rights reserved. Blogger Image Move Cleaned: 5/3/2021 1:35:54 PM
<br />

<!--   Copyright (c) gojimmypi all rights reserved.  -->